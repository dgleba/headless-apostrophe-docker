{% macro icon(class) %}
  <svg class="{{ class }}">
    <g>
      <circle cx="16" cy="16" r="15.12"></circle>
      <path d="M16.14 9.93L22.21 16l-6.07 6.07M8.23 16h13.98"></path>
    </g>
  </svg>
{% endmacro %}

{% macro menubar(menus, children, showPageTitle) %}
  {% set homePage = true %}
  {% if (children | int) === children %} {# if children is an integer, it's coming from a single page, otherwise from home #}
    {% set homePage = false %}
  {% endif %}

  <nav class="at_menu {%- if not homePage %} at_menu--appear {%- endif %}" {%- if not homePage %} data-page="{{ children }}" {%- endif %}>
      {% for menu in menus %}
        <nav
          class="at_menu__{{ loop.index }}
            {%- if not homePage %}
              {% if children === loop.index %} at_menu__{{ loop.index }}--appear at_menu__{{ loop.index }}--appeared
              {%- else %} at_menu__{{ loop.index  }}--disappear{%- endif -%}
            {%- endif %}"
          page={{ loop.index }}
          url="/{{ menu.slug }}"
          animate="menu"
        >
          <span class="at_menu__back" page={{ loop.index }} url="/ {%- if showPageTitle -%} {{ menu.slug }} {%- endif -%}" {% if not showPageTitle -%} animate="menu" {%- endif -%}> {# if "show" page, do not animate page transition #}
            {{ icon("at_menu icon") }}
            {{ icon("at_menu icon icon--hidden") }}
          </span>
          <div class="at_menu__breadcrumb breadcrumb {%- if showPageTitle %} at_menu__breadcrumb--show {%- endif %}">
            <span class="breadcrumb__root" page={{ loop.index }} url="/" animate="menu">Accueil</span>
            <div class="breadcrumb__show {%- if showPageTitle %} breadcrumb__show--visible {%- endif %}">
              <div class="breadcrumb__slash"></div>
              <span class="breadcrumb__list" page={{ loop.index }} url="/{{ menu.slug }}">{{ menu.title }}</span>
            </div>
          </div>
          <span class="at_menu__title" title="{{ menu.title }}">
            {%- if showPageTitle -%} {{ showPageTitle }} {%- else -%} {{ menu.title }} {%- endif -%}
          </span>
        </nav>
      {% endfor %}
  </nav>
{% endmacro %}